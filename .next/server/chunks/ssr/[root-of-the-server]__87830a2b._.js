module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70864,a=>{a.n(a.i(33290))},73714,a=>{a.n(a.i(82143))},99744,a=>{a.n(a.i(35385))},21337,a=>{a.n(a.i(16582))},59706,a=>{a.n(a.i(93550))},37967,a=>{"use strict";let b=(0,a.i(94355).registerClientReference)(function(){throw Error("Attempted to call ShopDirectory() from the server but ShopDirectory is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/shop-directory.tsx <module evaluation>","ShopDirectory");a.s(["ShopDirectory",0,b])},34056,a=>{"use strict";let b=(0,a.i(94355).registerClientReference)(function(){throw Error("Attempted to call ShopDirectory() from the server but ShopDirectory is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/shop-directory.tsx","ShopDirectory");a.s(["ShopDirectory",0,b])},53502,a=>{"use strict";a.i(37967);var b=a.i(34056);a.n(b)},49557,a=>{"use strict";var b=a.i(43392),c=a.i(98310),d=a.i(53502);function e(a){return a.toLowerCase().replace(/[^a-z0-9\s]/g,"").trim()}function f(a,b,c){let d=[],f=0,g=(a||[]).map(a=>e(a)),h=(c||[]).filter(a=>a.name).map(a=>({name:e(a.name),description:a.description?e(a.description):"",type:a.type?e(a.type):"",fullText:`${e(a.name)} ${a.description?e(a.description):""} ${a.type?e(a.type):""}`.trim()}));if(0===g.length&&0===h.length)return{matches:!1,score:0,matchedTerms:[]};let i=b.device_brand?e(b.device_brand):b.device_type?function(a){let b=e(a);for(let[a,c]of[["one plus","oneplus"],["oneplus","oneplus"],["hewlett packard","hp"],["macbook","apple"],["imac","apple"],["ipad","apple"],["ipod","apple"],["iphone","apple"],["galaxy","samsung"],["thinkpad","lenovo"],["alienware","dell"],["rog","asus"],["xperia","sony"],["pixel","google"],["redmi","xiaomi"],["poco","xiaomi"],["surface","microsoft"],["apple","apple"],["samsung","samsung"],["oneplus","oneplus"],["google","google"],["xiaomi","xiaomi"],["oppo","oppo"],["realme","realme"],["vivo","vivo"],["huawei","huawei"],["honor","honor"],["sony","sony"],["lg","lg"],["motorola","motorola"],["moto","motorola"],["nokia","nokia"],["dell","dell"],["hp","hp"],["lenovo","lenovo"],["asus","asus"],["acer","acer"],["msi","msi"],["razer","razer"],["microsoft","microsoft"]])if(b.includes(a))return c;return b.split(/\s+/)[0]||""}(b.device_type):"";if(i){let a=g.some(a=>{let b=e(a);return b.includes(i)||i.includes(b)||b.startsWith(i)||i.startsWith(b)}),b=h.some(a=>a.fullText.includes(i)||a.name.includes(i)||a.type.includes(i));(a||b)&&(f+=3,d.push(i))}if(b.device_type){let a=e(b.device_type),c=g.some(b=>{let c=e(b);return c.includes(a)||a.includes(c)||a.startsWith(c)||c.startsWith(a.split(" ")[0])}),i=h.some(b=>b.fullText.includes(a)||b.name.includes(a)||b.description.includes(a));(c||i)&&(f+=2,d.push(b.device_type))}if(b.repair_component){let a=[...function(a){let b=e(a),c=[b];for(let[a,d]of Object.entries({screen:["display","lcd","oled","amoled","touchscreen","touch screen"],display:["screen","lcd","oled","amoled","touchscreen"],battery:["power","charging","cell"],camera:["lens","photo","picture"],"charging port":["usb port","charging","port","connector"],speaker:["audio","sound"],microphone:["mic","audio input"],motherboard:["mainboard","logic board","pcb"],keyboard:["keys","typing"],trackpad:["touchpad","mouse pad"]}))(b.includes(a)||a.includes(b))&&c.push(...d);return[...new Set(c)]}(b.repair_component),...(b.repair_keywords||[]).map(a=>e(a))],c=g.some(b=>{let c=e(b);return a.some(a=>{let b=e(a);return c.includes(b)||b.includes(c)||c.startsWith(b)||b.startsWith(c)||c.split(/\s+/).includes(b)||b.split(/\s+/).includes(c)})}),i=h.some(b=>a.some(a=>{let c=e(a);return b.name.includes(c)||c.includes(b.name)||b.description.includes(c)||c.includes(b.description)||b.type.includes(c)||c.includes(b.type)||b.fullText.includes(c)||c.includes(b.fullText)||b.name.split(/\s+/).includes(c)||b.description.split(/\s+/).includes(c)||b.type.split(/\s+/).includes(c)}));(c||i)&&(f+=3,d.push(b.repair_component))}return b.repair_keywords&&b.repair_keywords.forEach(a=>{let b=e(a),c=g.some(a=>{let c=e(a);return c.includes(b)||b.includes(c)}),i=h.some(a=>a.fullText.includes(b)||a.name.includes(b)||a.description.includes(b)||a.type.includes(b));(c||i)&&(f+=1,d.push(a))}),{matches:f>=3,score:f,matchedTerms:[...new Set(d)]}}var g=a.i(18464),h=a.i(27208);let i="https://www.fixwise.be";async function j(){let a=await (0,h.headers)(),b=(0,g.getLocaleFromHeaders)(a);return(0,g.getShopsPageMetadata)(b)}async function k({searchParams:a}){let e=await a,g=await (0,c.createClient)(),h={"@context":"https://schema.org","@type":"ItemList",name:"Repair Shops Directory",description:"Find trusted local repair shops for phone, laptop, and tablet repairs",url:`${i}/shops`,numberOfItems:0,itemListElement:[]},j=null,k=null;if(e.diagnosis){let{data:a}=await g.from("diagnoses").select("*").eq("id",e.diagnosis).single();j=a,j?.ai_response?.repair_component&&(k=j.ai_response.repair_component.toLowerCase())}let{data:l,error:m}=await g.from("repair_shops").select("*"),{data:n}=await g.from("shop_products").select("*").eq("category","service"),o=new Map;n&&n.forEach(a=>{o.has(a.shop_id)||o.set(a.shop_id,[]),o.get(a.shop_id).push(a)});let p=(l||[]).map(a=>({...a,shop_products:o.get(a.id)||[]}));m&&console.error("Error fetching shops:",m);let q=p||[];if(j?.ai_response){var r;let a={device_brand:j.ai_response.device_brand,device_type:j.ai_response.device_type,repair_component:j.ai_response.repair_component,repair_keywords:j.ai_response.repair_keywords};r=q=q.filter(b=>{let c=(b.shop_products||[]).filter(a=>"service"===a.category&&!1!==a.in_stock);return f(b.expertise||[],a,c).matches}),0===(q=r.map(b=>{let c=(b.shop_products||[]).filter(a=>"service"===a.category&&!1!==a.in_stock);return{...b,matchResult:f(b.expertise||[],a,c)}}).sort((a,b)=>b.matchResult.score!==a.matchResult.score?b.matchResult.score-a.matchResult.score:b.rating!==a.rating?(b.rating||0)-(a.rating||0):void 0!==a.distance&&void 0!==b.distance?a.distance-b.distance:0)).length&&k&&(q=(p||[]).filter(b=>{let c=(b.expertise||[]).map(a=>a.toLowerCase()),d=(b.shop_products||[]).filter(a=>"service"===a.category).map(a=>`${a.name} ${a.description||""} ${a.type||""}`.toLowerCase()),e=k.toLowerCase(),f=c.some(b=>b.includes(e)||e.includes(b)||a.device_brand&&b.includes(a.device_brand.toLowerCase())),g=d.some(b=>b.includes(e)||e.includes(b)||a.device_brand&&b.includes(a.device_brand.toLowerCase()));return f||g})).sort((a,b)=>(b.rating||0)-(a.rating||0))}else q.sort((a,b)=>(b.rating||0)-(a.rating||0));return h.numberOfItems=q.length,h.itemListElement=q.slice(0,10).map((a,b)=>({"@type":"ListItem",position:b+1,item:{"@type":"LocalBusiness",name:a.name,url:`${i}/shops/${a.id}`,address:{"@type":"PostalAddress",streetAddress:a.address}}})),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(h)}}),(0,b.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Home",item:i},{"@type":"ListItem",position:2,name:"Repair Shops",item:`${i}/shops`}]})}}),(0,b.jsx)(d.ShopDirectory,{shops:q,diagnosis:j,repairComponent:k})]})}a.s(["default",()=>k,"generateMetadata",()=>j],49557)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__87830a2b._.js.map