module.exports=[76929,a=>{"use strict";let b=(0,a.i(61237).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],76929)},3803,a=>{"use strict";let b=(0,a.i(61237).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],3803)},32402,36717,34315,a=>{"use strict";var b=a.i(61237);let c=(0,b.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["default",()=>c],32402);let d=(0,b.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);a.s(["default",()=>d],36717);var e=a.i(31976);a.s(["CalendarIcon",()=>e.default],34315)},26345,a=>{"use strict";let b=(0,a.i(61237).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);a.s(["Mail",()=>b],26345)},75407,a=>{"use strict";let b=(0,a.i(61237).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);a.s(["Phone",()=>b],75407)},19113,a=>{"use strict";let b=(0,a.i(61237).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],19113)},88521,a=>{"use strict";var b=a.i(96974),c=a.i(3130),d=a.i(54161),e=a.i(40695),f=a.i(1556),g=a.i(76929),h=a.i(19113),i=a.i(3803),j=a.i(26345),k=a.i(75407),l=a.i(73608),m=a.i(16590),n=a.i(55005),o=a.i(69240);function p({initialBookings:a,isShopOwner:p=!1,shopId:q,userId:r}){let s=(0,n.useRouter)(),[t,u]=(0,m.useState)(a),[v,w]=(0,m.useState)(null);(0,m.useEffect)(()=>{let a=(0,o.createClient)(),b=a.channel("bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:q?`shop_id=eq.${q}`:r?`user_id=eq.${r}`:void 0},a=>{console.log("Booking change received:",a),"INSERT"===a.eventType?u(b=>{let c=a.new;return b.find(a=>a.id===c.id)?b:[c,...b].sort((a,b)=>{let c=new Date(`${a.appointment_date}T${a.appointment_time}`),d=new Date(`${b.appointment_date}T${b.appointment_time}`);return c.getTime()-d.getTime()})}):"UPDATE"===a.eventType?u(b=>b.map(b=>b.id===a.new.id?a.new:b)):"DELETE"===a.eventType&&u(b=>b.filter(b=>b.id!==a.old.id))}).subscribe();return()=>{a.removeChannel(b)}},[q,r]);let x=async(a,b)=>{w(a);try{if(!(await fetch(`/api/bookings/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})})).ok)throw Error("Failed to update booking");s.refresh()}catch(a){console.error("Error updating booking:",a),alert("Failed to update booking status")}finally{w(null)}};return 0===t.length?(0,b.jsx)(c.Card,{children:(0,b.jsx)(c.CardContent,{className:"py-8 text-center text-muted-foreground",children:"No bookings found."})}):(0,b.jsx)("div",{className:"space-y-4",children:t.map(a=>(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"p-4 sm:p-6",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)(c.CardTitle,{className:"text-base sm:text-lg break-words",children:p?a.user_name:a.shop?.name}),(0,b.jsxs)("div",{className:"mt-2 flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(f.Calendar,{className:"h-4 w-4 flex-shrink-0"}),(0,l.format)(new Date(a.appointment_date),"PPP")]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(g.Clock,{className:"h-4 w-4 flex-shrink-0"}),a.appointment_time]})]})]}),(0,b.jsx)(d.Badge,{className:(a=>{switch(a){case"confirmed":return"bg-green-500/10 text-green-700 dark:text-green-400";case"completed":return"bg-blue-500/10 text-blue-700 dark:text-blue-400";case"cancelled":return"bg-red-500/10 text-red-700 dark:text-red-400";default:return"bg-yellow-500/10 text-yellow-700 dark:text-yellow-400"}})(a.status),children:a.status})]})}),(0,b.jsxs)(c.CardContent,{className:"space-y-4 p-4 sm:p-6 pt-0",children:[p?(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.User,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsx)("span",{className:"break-words",children:a.user_name})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)(j.Mail,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsx)("a",{href:`mailto:${a.user_email}`,className:"hover:underline truncate text-primary",children:a.user_email})]}),a.user_phone&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Phone,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsx)("a",{href:`tel:${a.user_phone}`,className:"hover:underline text-primary",children:a.user_phone})]})]}):a.shop&&(0,b.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,b.jsx)(h.MapPin,{className:"mt-1 h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsx)("span",{className:"break-words",children:a.shop.address})]}),a.notes&&(0,b.jsxs)("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[(0,b.jsx)("p",{className:"font-medium",children:"Notes:"}),(0,b.jsx)("p",{className:"mt-1 text-muted-foreground break-words",children:a.notes})]}),p&&"pending"===a.status&&(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsx)(e.Button,{size:"sm",onClick:()=>x(a.id,"confirmed"),disabled:v===a.id,className:"w-full sm:w-auto",children:"Confirm"}),(0,b.jsx)(e.Button,{size:"sm",variant:"destructive",onClick:()=>x(a.id,"cancelled"),disabled:v===a.id,className:"w-full sm:w-auto",children:"Cancel"})]}),p&&"confirmed"===a.status&&(0,b.jsx)(e.Button,{size:"sm",onClick:()=>x(a.id,"completed"),disabled:v===a.id,className:"w-full sm:w-auto",children:"Mark as Completed"}),!p&&"pending"===a.status&&(0,b.jsx)(e.Button,{size:"sm",variant:"outline",onClick:()=>x(a.id,"cancelled"),disabled:v===a.id,className:"w-full sm:w-auto",children:"Cancel Booking"})]})]},a.id))})}a.s(["BookingListRealtime",()=>p])},29546,a=>{"use strict";var b=a.i(96974),c=a.i(16590),d=a.i(3130),e=a.i(40695),f=a.i(32402),f=f,g=a.i(36717),g=g,h=a.i(34315),i=a.i(69240),j=a.i(55005);function k({initialBookings:a,shopId:k,userId:l}){let m=(0,j.useRouter)(),[n,o]=(0,c.useState)(new Date),[p,q]=(0,c.useState)(a);(0,c.useEffect)(()=>{let a=(0,i.createClient)(),b=a.channel("bookings-calendar-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:k?`shop_id=eq.${k}`:l?`user_id=eq.${l}`:void 0},a=>{if("INSERT"===a.eventType){let b=a.new;q(a=>a.find(a=>a.id===b.id)?a:[...a,b])}else"UPDATE"===a.eventType?q(b=>b.map(b=>b.id===a.new.id?a.new:b)):"DELETE"===a.eventType&&q(b=>b.filter(b=>b.id!==a.old.id))}).subscribe();return()=>{a.removeChannel(b)}},[k,l]);let r=n.getFullYear(),s=n.getMonth(),t=new Date(r,s,1),u=new Date(r,s+1,0).getDate(),v=t.getDay(),w={pending:"bg-yellow-100 text-yellow-800 border-yellow-300",confirmed:"bg-blue-100 text-blue-800 border-blue-300",completed:"bg-green-100 text-green-800 border-green-300",cancelled:"bg-red-100 text-red-800 border-red-300"};return(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"p-4 sm:p-6",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2 text-lg sm:text-xl",children:[(0,b.jsx)(h.CalendarIcon,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"Bookings Calendar"]}),(0,b.jsxs)("div",{className:"flex items-center justify-between sm:justify-end gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"icon",onClick:()=>{o(new Date(r,s-1,1))},className:"h-8 w-8 sm:h-10 sm:w-10",children:(0,b.jsx)(f.default,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"min-w-[120px] sm:min-w-[150px] text-center text-sm sm:text-base font-semibold",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][s]," ",r]}),(0,b.jsx)(e.Button,{variant:"outline",size:"icon",onClick:()=>{o(new Date(r,s+1,1))},className:"h-8 w-8 sm:h-10 sm:w-10",children:(0,b.jsx)(g.default,{className:"h-4 w-4"})})]})]})}),(0,b.jsxs)(d.CardContent,{className:"p-3 sm:p-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-7 gap-1 sm:gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>(0,b.jsx)("div",{className:"p-1 sm:p-2 text-center text-xs sm:text-sm font-semibold text-muted-foreground",children:a},a)),Array.from({length:v}).map((a,c)=>(0,b.jsx)("div",{className:"p-1 sm:p-2"},`empty-${c}`)),Array.from({length:u}).map((a,c)=>{let d,e=c+1,f=(d=`${r}-${String(s+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`,p.filter(a=>a.appointment_date===d)),g=e===new Date().getDate()&&s===new Date().getMonth()&&r===new Date().getFullYear();return(0,b.jsxs)("div",{onClick:()=>{let a;return a=`${r}-${String(s+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`,void(k?m.push(`/shop/bookings/${a}`):l&&m.push(`/user/bookings/${a}`))},className:`min-h-[60px] sm:min-h-[100px] cursor-pointer rounded-lg border p-1 sm:p-2 transition-colors hover:bg-accent ${g?"border-primary bg-primary/5":"border-border"} ${f.length>0?"hover:border-primary":""}`,children:[(0,b.jsx)("div",{className:`mb-1 text-xs sm:text-sm font-semibold ${g?"text-primary":""}`,children:e}),(0,b.jsxs)("div",{className:"space-y-0.5 sm:space-y-1",children:[f.slice(0,2).map(a=>(0,b.jsxs)("div",{className:`rounded border px-0.5 sm:px-1 py-0.5 text-[10px] sm:text-xs ${w[a.status]||w.pending}`,children:[(0,b.jsx)("div",{className:"font-medium truncate",children:a.appointment_time}),(0,b.jsx)("div",{className:"truncate hidden sm:block",children:a.user_name})]},a.id)),f.length>2&&(0,b.jsxs)("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:["+",f.length-2]})]})]},e)})]}),(0,b.jsxs)("div",{className:"mt-4 sm:mt-6 flex flex-wrap gap-3 sm:gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-yellow-500"}),(0,b.jsx)("span",{className:"text-xs sm:text-sm",children:"Pending"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-blue-500"}),(0,b.jsx)("span",{className:"text-xs sm:text-sm",children:"Confirmed"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-green-500"}),(0,b.jsx)("span",{className:"text-xs sm:text-sm",children:"Completed"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-red-500"}),(0,b.jsx)("span",{className:"text-xs sm:text-sm",children:"Cancelled"})]})]})]})]})}a.s(["BookingsCalendarRealtime",()=>k],29546)}];

//# sourceMappingURL=_edd3959f._.js.map