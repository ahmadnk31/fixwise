{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/ss/Downloads/ai-repair-diagnosis-saas-main/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient as createSupabaseServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\nexport async function createServerClient() {\n  const cookieStore = await cookies()\n\n  return createSupabaseServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // The \"setAll\" method was called from a Server Component.\n          // This can be ignored if you have middleware refreshing\n          // user sessions.\n        }\n      },\n    },\n  })\n}\n\nexport const createClient = createServerClient\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,mTAAO;IAEjC,OAAO,IAAA,8SAA0B,sUAAoF;QACnH,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AACF;AAEO,MAAM,eAAe","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///Users/ss/Downloads/ai-repair-diagnosis-saas-main/app/api/products/route.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\"\nimport { NextRequest, NextResponse } from \"next/server\"\n\nexport async function GET(request: NextRequest) {\n  const supabase = await createClient()\n  const { searchParams } = new URL(request.url)\n  const shopId = searchParams.get(\"shopId\")\n\n  try {\n    let query = supabase.from(\"shop_products\").select(\"*\").order(\"created_at\", { ascending: false })\n\n    if (shopId) {\n      query = query.eq(\"shop_id\", shopId)\n    }\n\n    const { data, error } = await query\n\n    if (error) throw error\n\n    return NextResponse.json({ products: data })\n  } catch (error: any) {\n    console.error(\"[v0] Error fetching products:\", error)\n    return NextResponse.json({ error: error.message }, { status: 500 })\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  const supabase = await createClient()\n\n  try {\n    const {\n      data: { user },\n    } = await supabase.auth.getUser()\n\n    if (!user) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    const formData = await request.formData()\n    const name = formData.get(\"name\") as string\n    const description = formData.get(\"description\") as string\n    const category = formData.get(\"category\") as string\n    const type = formData.get(\"type\") as string\n    const price = formData.get(\"price\") as string\n    const shopId = formData.get(\"shopId\") as string\n    const image = formData.get(\"image\") as File | null\n\n    let imageUrl = null\n\n    // Upload image to Supabase Storage if provided\n    if (image && image.size > 0) {\n      const fileExt = image.name.split(\".\").pop()\n      const fileName = `${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`\n      const filePath = `products/${fileName}`\n\n      const { data: uploadData, error: uploadError } = await supabase.storage\n        .from(\"product-images\")\n        .upload(filePath, image, {\n          contentType: image.type,\n          cacheControl: \"3600\",\n        })\n\n      if (uploadError) {\n        console.error(\"Image upload error:\", uploadError)\n      } else {\n        const {\n          data: { publicUrl },\n        } = supabase.storage.from(\"product-images\").getPublicUrl(filePath)\n        imageUrl = publicUrl\n      }\n    }\n\n    const { data, error } = await supabase\n      .from(\"shop_products\")\n      .insert({\n        shop_id: shopId,\n        name,\n        description,\n        category,\n        type,\n        price: price ? parseFloat(price) : null,\n        image_url: imageUrl,\n      })\n      .select()\n      .single()\n\n    if (error) throw error\n\n    return NextResponse.json({ product: data })\n  } catch (error: any) {\n    console.error(\"[v0] Error creating product:\", error)\n    return NextResponse.json({ error: error.message }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,WAAW,MAAM,IAAA,2IAAY;IACnC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;IAEhC,IAAI;QACF,IAAI,QAAQ,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC,KAAK,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE9F,IAAI,QAAQ;YACV,QAAQ,MAAM,EAAE,CAAC,WAAW;QAC9B;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO,MAAM;QAEjB,OAAO,uTAAY,CAAC,IAAI,CAAC;YAAE,UAAU;QAAK;IAC5C,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,uTAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,WAAW,MAAM,IAAA,2IAAY;IAEnC,IAAI;QACF,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IAAI,CAAC,MAAM;YACT,OAAO,uTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAC1B,MAAM,cAAc,SAAS,GAAG,CAAC;QACjC,MAAM,WAAW,SAAS,GAAG,CAAC;QAC9B,MAAM,OAAO,SAAS,GAAG,CAAC;QAC1B,MAAM,QAAQ,SAAS,GAAG,CAAC;QAC3B,MAAM,SAAS,SAAS,GAAG,CAAC;QAC5B,MAAM,QAAQ,SAAS,GAAG,CAAC;QAE3B,IAAI,WAAW;QAEf,+CAA+C;QAC/C,IAAI,SAAS,MAAM,IAAI,GAAG,GAAG;YAC3B,MAAM,UAAU,MAAM,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;YACzC,MAAM,WAAW,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE,SAAS;YACtF,MAAM,WAAW,CAAC,SAAS,EAAE,UAAU;YAEvC,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAAS,OAAO,CACpE,IAAI,CAAC,kBACL,MAAM,CAAC,UAAU,OAAO;gBACvB,aAAa,MAAM,IAAI;gBACvB,cAAc;YAChB;YAEF,IAAI,aAAa;gBACf,QAAQ,KAAK,CAAC,uBAAuB;YACvC,OAAO;gBACL,MAAM,EACJ,MAAM,EAAE,SAAS,EAAE,EACpB,GAAG,SAAS,OAAO,CAAC,IAAI,CAAC,kBAAkB,YAAY,CAAC;gBACzD,WAAW;YACb;QACF;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC;YACN,SAAS;YACT;YACA;YACA;YACA;YACA,OAAO,QAAQ,WAAW,SAAS;YACnC,WAAW;QACb,GACC,MAAM,GACN,MAAM;QAET,IAAI,OAAO,MAAM;QAEjB,OAAO,uTAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,uTAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF","debugId":null}}]
}