{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/ss/Downloads/ai-repair-diagnosis-saas-main/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient as createSupabaseServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\nexport async function createServerClient() {\n  const cookieStore = await cookies()\n\n  return createSupabaseServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // The \"setAll\" method was called from a Server Component.\n          // This can be ignored if you have middleware refreshing\n          // user sessions.\n        }\n      },\n    },\n  })\n}\n\nexport const createClient = createServerClient\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,mTAAO;IAEjC,OAAO,IAAA,8SAA0B,sUAAoF;QACnH,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AACF;AAEO,MAAM,eAAe","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///Users/ss/Downloads/ai-repair-diagnosis-saas-main/app/api/leads/route.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\"\nimport { NextResponse } from \"next/server\"\n\nexport async function POST(req: Request) {\n  try {\n    const { diagnosisId, shopId } = await req.json()\n\n    console.log(\"[v0] Creating lead - diagnosisId:\", diagnosisId, \"shopId:\", shopId)\n\n    if (!diagnosisId || !shopId) {\n      console.log(\"[v0] Missing required fields\")\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\n    }\n\n    const supabase = await createClient()\n\n    const [diagnosisCheck, shopCheck] = await Promise.all([\n      supabase.from(\"diagnoses\").select(\"id\").eq(\"id\", diagnosisId).single(),\n      supabase.from(\"repair_shops\").select(\"id\").eq(\"id\", shopId).single(),\n    ])\n\n    console.log(\"[v0] Diagnosis check:\", diagnosisCheck)\n    console.log(\"[v0] Shop check:\", shopCheck)\n\n    if (diagnosisCheck.error) {\n      console.log(\"[v0] Diagnosis not found\")\n      return NextResponse.json({ error: \"Diagnosis not found\" }, { status: 404 })\n    }\n\n    if (shopCheck.error) {\n      console.log(\"[v0] Shop not found\")\n      return NextResponse.json({ error: \"Shop not found\" }, { status: 404 })\n    }\n\n    // Create a lead\n    const { data, error } = await supabase\n      .from(\"leads\")\n      .insert({\n        diagnosis_id: diagnosisId,\n        shop_id: shopId,\n        status: \"pending\",\n      })\n      .select()\n      .single()\n\n    if (error) {\n      console.error(\"[v0] Database error creating lead:\", error)\n      return NextResponse.json({ error: \"Failed to create lead\", details: error.message }, { status: 500 })\n    }\n\n    console.log(\"[v0] Lead created successfully:\", data.id)\n    return NextResponse.json({ lead: data })\n  } catch (error) {\n    console.error(\"[v0] Lead creation error:\", error)\n    return NextResponse.json(\n      { error: \"Failed to create lead\", details: error instanceof Error ? error.message : \"Unknown error\" },\n      { status: 500 },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,WAAW,EAAE,MAAM,EAAE,GAAG,MAAM,IAAI,IAAI;QAE9C,QAAQ,GAAG,CAAC,qCAAqC,aAAa,WAAW;QAEzE,IAAI,CAAC,eAAe,CAAC,QAAQ;YAC3B,QAAQ,GAAG,CAAC;YACZ,OAAO,uTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,WAAW,MAAM,IAAA,2IAAY;QAEnC,MAAM,CAAC,gBAAgB,UAAU,GAAG,MAAM,QAAQ,GAAG,CAAC;YACpD,SAAS,IAAI,CAAC,aAAa,MAAM,CAAC,MAAM,EAAE,CAAC,MAAM,aAAa,MAAM;YACpE,SAAS,IAAI,CAAC,gBAAgB,MAAM,CAAC,MAAM,EAAE,CAAC,MAAM,QAAQ,MAAM;SACnE;QAED,QAAQ,GAAG,CAAC,yBAAyB;QACrC,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,IAAI,eAAe,KAAK,EAAE;YACxB,QAAQ,GAAG,CAAC;YACZ,OAAO,uTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,IAAI,UAAU,KAAK,EAAE;YACnB,QAAQ,GAAG,CAAC;YACZ,OAAO,uTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,gBAAgB;QAChB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,SACL,MAAM,CAAC;YACN,cAAc;YACd,SAAS;YACT,QAAQ;QACV,GACC,MAAM,GACN,MAAM;QAET,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,sCAAsC;YACpD,OAAO,uTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAyB,SAAS,MAAM,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QACrG;QAEA,QAAQ,GAAG,CAAC,mCAAmC,KAAK,EAAE;QACtD,OAAO,uTAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAK;IACxC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,uTAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAyB,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAAgB,GACpG;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}